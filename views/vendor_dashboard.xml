<odoo>
    <template id="portal_vendor_dashboard" name="Vendor Dashboard">
        <t t-call="marketplace_platform.minimal_layout">
            <div id="wrap" class="bg-light-cream" style="min-height: 100vh;">
                
                <!-- 1. Global Header -->
                <t t-call="marketplace_platform.navbar_component"/>
                
                <!-- 2. Vendor Sub-Navbar -->
                <t t-call="marketplace_platform.vendor_navbar_component"/>
                
                <!-- 3. Dashboard Content -->
                <div class="vendor-content-wrapper">
                    <div class="container py-5">
                    
                    <!-- Welcome & Quick Actions -->
                    <div class="d-flex justify-content-between align-items-center mb-5">
                        <div>
                            <h2 class="fw-bold text-dark mb-1">Dashboard</h2>
                            <p class="text-muted mb-0">Welcome back, <span class="text-aura-primary"><t t-esc="vendor.shop_name"/></span></p>
                        </div>
                        <a href="/my/marketplace/products/add" class="btn btn-aura-primary rounded-pill px-4 shadow-sm">
                            <i class="fa fa-plus me-2"/> Add Product
                        </a>
                    </div>

                    <!-- Metrics Grid -->
                    <div class="row g-4 mb-5">
                        <!-- Total Sales -->
                        <div class="col-md-3 col-sm-6">
                            <div class="vendor-stat-card">
                                <div class="stat-icon-wrapper green">
                                    <i class="fa fa-dollar"/>
                                </div>
                                <h3 class="fw-bold mb-1" t-options="{'widget': 'monetary', 'display_currency': website.currency_id}" t-esc="metrics['sales']"/>
                                <p class="text-muted small mb-0">Total Sales</p>
                            </div>
                        </div>
                        <!-- Total Orders -->
                        <div class="col-md-3 col-sm-6">
                            <div class="vendor-stat-card">
                                <div class="stat-icon-wrapper blue">
                                    <i class="fa fa-shopping-bag"/>
                                </div>
                                <h3 class="fw-bold mb-1" t-esc="metrics['orders']"/>
                                <p class="text-muted small mb-0">Total Orders</p>
                            </div>
                        </div>
                        <!-- Active Products -->
                        <div class="col-md-3 col-sm-6">
                            <div class="vendor-stat-card">
                                <div class="stat-icon-wrapper purple">
                                    <i class="fa fa-cube"/>
                                </div>
                                <h3 class="fw-bold mb-1" t-esc="metrics['products']"/>
                                <p class="text-muted small mb-0">Active Products</p>
                            </div>
                        </div>
                        <!-- Balance -->
                        <div class="col-md-3 col-sm-6">
                            <div class="vendor-stat-card">
                                <div class="stat-icon-wrapper orange">
                                    <i class="fa fa-wallet"/>
                                </div>
                                <h3 class="fw-bold mb-1" t-options="{'widget': 'monetary', 'display_currency': website.currency_id}" t-esc="metrics['balance']"/>
                                <p class="text-muted small mb-0">Available Balance</p>
                            </div>
                        </div>
                    </div>

                    <!-- Main Grid: Recent Orders & Shortcuts -->
                    <div class="row g-4">
                        
                        <!-- Left: Sales Chart & Recent Orders -->
                        <div class="col-lg-8">
                            <!-- Sales Chart -->
                            <div class="bg-white rounded-4 shadow-sm p-4 border mb-4">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <h5 class="fw-bold m-0">Sales Overview</h5>
                                    <div class="btn-group btn-group-sm" role="group">
                                        <button type="button" class="btn btn-outline-secondary active" onclick="changeChartType('bar')">
                                            <i class="fa fa-bar-chart"/> Bar
                                        </button>
                                        <button type="button" class="btn btn-outline-secondary" onclick="changeChartType('line')">
                                            <i class="fa fa-line-chart"/> Line
                                        </button>
                                        <button type="button" class="btn btn-outline-secondary" onclick="changeChartType('pie')">
                                            <i class="fa fa-pie-chart"/> Pie
                                        </button>
                                    </div>
                                </div>
                                <div style="height: 300px; position: relative;">
                                    <canvas id="salesChart"></canvas>
                                </div>
                            </div>
                            
                            <div class="bg-white rounded-4 shadow-sm p-4 border h-100">
                                <div class="d-flex justify-content-between align-items-center mb-4">
                                    <h5 class="fw-bold m-0">Recent Orders</h5>
                                    <a href="/my/marketplace/orders" class="text-decoration-none text-muted small">View all</a>
                                </div>
                                
                                <t t-if="recent_orders">
                                    <div class="list-group list-group-flush">
                                        <t t-foreach="recent_orders" t-as="order">
                                            <div class="list-group-item border-0 px-0">
                                                <div class="d-flex justify-content-between align-items-center">
                                                    <div>
                                                        <div class="fw-bold"><t t-esc="order.name"/></div>
                                                        <div class="small text-muted">
                                                            <t t-esc="order.partner_id.name"/> â€¢ 
                                                            <t t-esc="order.date_order" t-options='{"widget": "date"}'/>
                                                        </div>
                                                    </div>
                                                    <div class="text-end">
                                                        <div class="fw-bold">
                                                            <span t-field="order.amount_total" t-options="{'widget': 'monetary'}"/>
                                                        </div>
                                                        <span t-attf-class="badge rounded-pill #{'bg-success' if order.state == 'sale' else 'bg-warning'}">
                                                            <t t-esc="order.state"/>
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                        </t>
                                    </div>
                                </t>
                                <t t-else="">
                                    <div class="text-center py-5 text-muted">
                                        <i class="fa fa-inbox fa-3x mb-3 opacity-25"/>
                                        <p>No orders received yet.</p>
                                        <p class="small">Orders will appear here when customers purchase your products.</p>
                                    </div>
                                </t>
                            </div>
                        </div>

                        <!-- Right: Notifications & Shortcuts -->
                        <div class="col-lg-4">
                            
                            <!-- Shortcuts -->
                            <div class="d-flex flex-column gap-3 mb-4">
                                <a href="/my/marketplace/products/add" class="vendor-shortcut-btn shadow-sm">
                                    <span class="d-flex align-items-center gap-3">
                                        <span class="bg-primary bg-opacity-10 p-2 rounded-circle text-primary"><i class="fa fa-plus"/></span>
                                        <span class="fw-bold">Add New Product</span>
                                    </span>
                                    <i class="fa fa-chevron-right text-muted small"/>
                                </a>
                                <a href="/my/marketplace/orders" class="vendor-shortcut-btn shadow-sm">
                                    <span class="d-flex align-items-center gap-3">
                                        <span class="bg-warning bg-opacity-10 p-2 rounded-circle text-warning"><i class="fa fa-list"/></span>
                                        <span class="fw-bold">Manage Orders</span>
                                    </span>
                                    <i class="fa fa-chevron-right text-muted small"/>
                                </a>
                            </div>

                            <!-- Notifications / System Status -->
                            <div class="bg-white rounded-4 shadow-sm p-4 border">
                                <h5 class="fw-bold mb-3">Notifications</h5>
                                <div class="d-flex flex-column gap-0">
                                    <!-- Dynamic Logic: Check Low Stock -->
                                    <div class="vendor-notif-item">
                                        <i class="fa fa-exclamation-circle text-danger mt-1"/>
                                        <div>
                                            <div class="fw-bold text-dark small">System Update</div>
                                            <div class="text-muted small">Welcome to your new dashboard! Start by adding products.</div>
                                        </div>
                                    </div>
                                    <!-- Add more dynamic notifications later -->
                                </div>
                            </div>

                        </div>
                    </div>

                    </div>
                </div>
                
                <!-- Chart.js Script -->
                <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
                <script>
                    let salesChart;
                    const totalSales = <t t-esc="metrics['sales']"/>;
                    const totalOrders = <t t-esc="metrics['orders']"/>;
                    
                    // Generate realistic sample data
                    const chartData = {
                        labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                        datasets: [{
                            label: 'Sales',
                            data: generateSampleData(totalSales, 7),
                            backgroundColor: ['#4CAF50', '#66BB6A', '#81C784', '#A5D6A7', '#C8E6C9', '#E8F5E9', '#F1F8E9'],
                            borderColor: '#4CAF50',
                            borderWidth: 2,
                            borderRadius: 8,
                            tension: 0.4
                        }]
                    };
                    
                    function generateSampleData(total, days) {
                        if (total === 0) {
                            return [12, 19, 15, 25, 22, 30, 28];
                        }
                        const avg = total / days;
                        const variance = avg * 0.3;
                        return Array.from({length: days}, () => 
                            Math.max(0, avg + (Math.random() - 0.5) * variance * 2)
                        );
                    }
                    
                    function createChart(type = 'bar') {
                        const ctx = document.getElementById('salesChart');
                        if (!ctx) return;
                        
                        if (salesChart) {
                            salesChart.destroy();
                        }
                        
                        const config = {
                            type: type,
                            data: chartData,
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: { 
                                        display: type === 'pie',
                                        position: 'right'
                                    },
                                    tooltip: {
                                        callbacks: {
                                            label: function(context) {
                                                const value = type === 'pie' ? context.parsed : context.parsed.y;
                                                return ' $' + value.toFixed(2);
                                            }
                                        }
                                    }
                                },
                                scales: type !== 'pie' ? {
                                    y: { 
                                        beginAtZero: true,
                                        ticks: {
                                            callback: function(value) {
                                                return '$' + value.toFixed(0);
                                            }
                                        }
                                    }
                                } : {}
                            }
                        };
                        
                        salesChart = new Chart(ctx, config);
                    }
                    
                    function changeChartType(type) {
                        // Update active button
                        document.querySelectorAll('.btn-group button').forEach(btn => {
                            btn.classList.remove('active');
                        });
                        event.target.closest('button').classList.add('active');
                        
                        createChart(type);
                    }
                    
                    document.addEventListener('DOMContentLoaded', function() {
                        createChart('bar');
                    });
                </script>
                
                <t t-call="marketplace_platform.footer_component"/>
            </div>
        </t>
    </template>
</odoo>